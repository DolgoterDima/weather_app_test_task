{"version":3,"file":"js/752.27e6308d.js","mappings":"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","sources":["webpack://weather-app-test/./src/views/HomeView.vue","webpack://weather-app-test/src/views/HomeView.vue","webpack://weather-app-test/./src/views/HomeView.vue?2a07","webpack://weather-app-test/./src/views/HomeView.vue?aae2"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"home\"},[_c('div',{staticClass:\"days-list\"},[(_vm.loadingMessage)?_c('LoadingComponent',{attrs:{\"message\":_vm.loadingMessage}}):_vm._e(),_vm._l((_vm.daysList),function(day){return _c('DayCard',{key:day.id,staticClass:\"days-list__item\",attrs:{\"city\":day.city,\"id\":day.id},on:{\"remove\":_vm.removeDay,\"addToFavorite\":_vm.addDayToFavorite}})}),(_vm.isShowAddNewDay)?_c('button',{staticClass:\"days-list__add\",on:{\"click\":_vm.addNewDay}},[_c('font-awesome-icon',{attrs:{\"icon\":\"plus\",\"size\":\"xl\"}})],1):_vm._e()],2)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"home\">\r\n    <div class=\"days-list\">\r\n      <LoadingComponent :message=\"loadingMessage\" v-if=\"loadingMessage\" />\r\n      <DayCard\r\n        class=\"days-list__item\"\r\n        v-for=\"day in daysList\"\r\n        :city=\"day.city\"\r\n        :key=\"day.id\"\r\n        :id=\"day.id\"\r\n        @remove=\"removeDay\"\r\n        @addToFavorite=\"addDayToFavorite\"\r\n      />\r\n      <button class=\"days-list__add\" @click=\"addNewDay\" v-if=\"isShowAddNewDay\">\r\n        <font-awesome-icon icon=\"plus\" size=\"xl\" />\r\n      </button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport DayCard from \"@/components/cards/DayCard.vue\";\r\n import { EventBus } from \"@/event-bus\";\r\nimport { library } from \"@fortawesome/fontawesome-svg-core\";\r\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons\";\r\nlibrary.add(faPlus);\r\n\r\nimport { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\r\n\r\nconst MAX_COUNT_OF_FAVORITES = 5;\r\nexport default {\r\n  name: \"HomeView\",\r\n\r\n  data() {\r\n    return {\r\n      daysList: [],\r\n      usersCity: \"222\",\r\n      favoritesList: [],\r\n\r\n      loadingMessage: \"\",\r\n    };\r\n  },\r\n  components: {\r\n    DayCard,\r\n    FontAwesomeIcon,\r\n  },\r\n  computed: {\r\n    isShowAddNewDay() {\r\n      return this.daysList.length < MAX_COUNT_OF_FAVORITES;\r\n    },\r\n  },\r\n  methods: {\r\n    async getCurrentUserCity() {\r\n      if (!navigator.geolocation) {\r\n        this.loadingMessage = \"Geolocation is not supported by this browser\";\r\n        return;\r\n      }\r\n\r\n      try {\r\n        this.loadingMessage = \"Detecting your current city\";\r\n\r\n        const position = await new Promise((resolve, reject) => {\r\n          navigator.geolocation.getCurrentPosition(resolve, reject);\r\n        });\r\n\r\n        const { latitude: lat, longitude: lon } = position.coords;\r\n        const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&accept-language=en`;\r\n\r\n        const response = await fetch(url);\r\n        const data = await response.json();\r\n\r\n        this.loadingMessage = \"\";\r\n        this.daysList.push({ id: Date.now(), city: data.address.city });\r\n      } catch (error) {\r\n        if (error.code == error.PERMISSION_DENIED) {\r\n          this.loadingMessage = \"You disallow access to geolocation\";\r\n          setTimeout(() => {\r\n            this.loadingMessage = \"\";\r\n            this.addNewDay();\r\n          }, 3000);\r\n        } else {\r\n          this.loadingMessage = `${error}. Please enter city name manually`;\r\n          setTimeout(() => {\r\n            this.loadingMessage = \"\";\r\n          }, 5000);\r\n          console.log(`API error ${error}`);\r\n          this.addNewDay();\r\n        }\r\n      }\r\n    },\r\n    /* getCurrentUserCity() {\r\n      if (navigator.geolocation) {\r\n        navigator.geolocation.getCurrentPosition( (position)=> {\r\n          this.loadingMessage = \"Detecting your current city\";\r\n\r\n            const lat = position.coords.latitude;\r\n            const lon = position.coords.longitude;\r\n            const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&accept-language=en`;\r\n\r\n            fetch(url)\r\n                .then((response) => response.json())\r\n                .then((data) => {\r\n                  this.loadingMessage = \"\";\r\n\r\n                  this.daysList.push({ id: Date.now(), city: data.address.city });\r\n                })\r\n                .catch((error) => {\r\n                  this.loadingMessage = `${error}. Please enter city name manually`;\r\n                  setTimeout(() => {\r\n                    this.loadingMessage = \"\";\r\n                  }, 5000);\r\n                  console.log(`API error ${error}`);\r\n                  this.addNewDay()\r\n                });\r\n\r\n         },  (error)=> {\r\n          if (error.code == error.PERMISSION_DENIED) {\r\n            this.loadingMessage = \"You disallow access to geolocation\";\r\n            setTimeout(()=>{\r\n              this.loadingMessage = \"\";\r\n              this.addNewDay()\r\n            }, 3000)\r\n          }\r\n        });\r\n      } else {\r\n        this.loadingMessage = \"Geolocation is not supported by this browser \";\r\n\r\n\r\n\r\n      }\r\n\r\n\r\n    },*/\r\n    removeDay(e) {\r\n      EventBus.$emit(\"open-popup\", {\r\n        text: `Do you really want to remove city? `,\r\n        id: e,\r\n      });\r\n      /*\r\n      this.daysList = this.daysList.filter((item) => item.id !== e);\r\n*/\r\n    },\r\n    addNewDay() {\r\n      this.daysList.push({ id: Date.now(), city: \"\" });\r\n    },\r\n    addDayToFavorite({ id, city }) {\r\n      /* проверка есть ли город в списке и не больше ли 5 городов в списке если нет, то добавляем*/\r\n      const isCityInFavorites = this.favoritesList.find(\r\n        (item) => item.city === city\r\n      );\r\n      const isFavoritesListMoreThenAllowedCount =\r\n        this.favoritesList.length > MAX_COUNT_OF_FAVORITES;\r\n\r\n      if (!isCityInFavorites && !isFavoritesListMoreThenAllowedCount) {\r\n        this.favoritesList.push({ id, city });\r\n        localStorage.setItem(\r\n          \"favoritesList\",\r\n          JSON.stringify(this.favoritesList)\r\n        );\r\n\r\n        /* change icon in card to filled heart when it added in favorites list */\r\n        EventBus.$emit(\"added-to-favorites\", id);\r\n      }\r\n\r\n      if (isFavoritesListMoreThenAllowedCount) {\r\n        EventBus.$emit(\"open-popup\", {\r\n          text: \"You can`t add more then 5 cities \",\r\n          id: false,\r\n        });\r\n      }\r\n\r\n      if (isCityInFavorites) {\r\n        EventBus.$emit(\"open-popup\", {\r\n          text: \"This city is already in your favorites\",\r\n          id: false,\r\n        });\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    /* this.addNewDay()*/\r\n    this.getCurrentUserCity();\r\n    console.log(\"localStorage\", localStorage.getItem(\"favoritesList\"));\r\n    this.favoritesList =\r\n      JSON.parse(localStorage.getItem(\"favoritesList\")) || [];\r\n  },\r\n  created() {\r\n    EventBus.$on(\"delete-card\", (id) => {\r\n      this.daysList = this.daysList.filter((item) => item.id !== id);\r\n    });\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./HomeView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./HomeView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./HomeView.vue?vue&type=template&id=50835c38&\"\nimport script from \"./HomeView.vue?vue&type=script&lang=js&\"\nexport * from \"./HomeView.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","loadingMessage","attrs","_e","_l","daysList","day","key","id","city","on","removeDay","addDayToFavorite","isShowAddNewDay","addNewDay","staticRenderFns","library","faPlus","MAX_COUNT_OF_FAVORITES","name","data","usersCity","favoritesList","components","DayCard","FontAwesomeIcon","computed","length","methods","navigator","geolocation","position","Promise","resolve","reject","getCurrentPosition","latitude","lat","longitude","lon","coords","url","response","fetch","json","push","Date","now","address","error","code","PERMISSION_DENIED","setTimeout","console","log","e","EventBus","text","isCityInFavorites","find","item","isFavoritesListMoreThenAllowedCount","localStorage","setItem","JSON","stringify","mounted","getCurrentUserCity","getItem","parse","created","filter","component"],"sourceRoot":""}